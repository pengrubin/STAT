---
title: "STAT0030_ICA2"
author: "Hongwei Peng"
date: "Student_Number:17052480"
output:
  pdf_document: 
    fig_caption: yes
  word_document: default
  html_document:
    df_print: paged
---

# R Question 1

## Question 1(a)
```{R question_1_a}
rawdata <- read.table("cars.dat", #input data
                      header=TRUE) #the first line as the names of the variables 
```
**Read the data into R.
**

 &nbsp;
 
##  Question 1(b)

```{R question_1_b.1}
summary(rawdata)
table(rawdata$tr)
```

**From this result, it shows that there are four variables. The range of the values between the last three variables is relatively large, so it is necessary to log the original data.
From the table results, the sample is divided into manual and automatic transmissions, of which 19 are automatic and 13 are manual.
**

 &nbsp;
 

```{R question_1_b.2, warning=FALSE}
logdata <- cbind(rawdata[,1],log(rawdata[,c(2,3,4)])) #log the data
names(logdata) <- c("tr","hp","wt","mpg")#rename the names of the variables 
pairs(logdata[,2:4], # plot log(hp), log(wt), log(mpg)
      main = "Plot Between log Variables", #add the main title
      pch = c(21,24)[unclass(logdata$tr)+1], #different tr shows different shape
      bg = c("red", "green3")[unclass(logdata$tr)+1]) #different tr shows different colour
```

```{R question_1_b.3, fig.height=3, fig.width=6, warning=FALSE}
par(mfrow=c(1,3))
boxplot(hp~tr, #HP by TR
        data=rawdata, #set the dataset
        xlab="Gear Transmission Type" , #add the xlab title
        ylab="Horsepower", #add the ylab title
        main="GP by TR", #add the main title
        names=c("Automatic","Manual")) #change xlab value to character
boxplot(wt~tr, #WT by TR
        data=rawdata, #set the dataset
        xlab="Gear Transmission Type" , #add the xlab title
        ylab="Weight of the Car in Pounds", #add the ylab title
        main="WT by TR", #add the main title
        names=c("Automatic","Manual")) #change xlab value to character
boxplot(mpg~tr, #MPG by TR
        data=rawdata, #set the dataset
        xlab="Gear Transmission Type" , #add the xlab title
        ylab="Miles Per Gallon", #add the ylab title
        main="MPG by TR", #add the main title
        names=c("Automatic","Manual")) #change xlab value to character
```

**The box plot shows a significant change between the automatic and manual gears between the various variables.
**

 &nbsp;
 

```{R question_1_b.4}
t.test(mpg~tr, data=logdata)# the t-test above MPG is related to TR.
```

##  question 1(c)

```{R question_1_c.1}
rawdata_model<-lm(mpg~tr+hp+wt, data=rawdata) #rawdata linear model
summary(rawdata_model)
logdata_model<-lm(mpg~tr+hp+wt, data=logdata) #logdata linear model
summary(logdata_model)
```
```{R question_1_c.2, message=FALSE, warning=FALSE,results = 'hide'}
best_model<-step(logdata_model, direction="both")
```
```{R question_1_c.3}
summary(best_model)
par(mfrow=c(2,2)) #put 4 graphes together
plot(best_model)#plot 4 graphes as following. 
```

---
title: "STAT0030_ICA2"
author: "Hongwei Peng"
date: "10/02/2019"
output:
  pdf_document: default
  word_document: default
  html_document:
    df_print: paged
---

# R Question 1

## Question 1a read the data
```{R question_1_a}
rawdata <- read.table("cars.dat", #input data
                      header=TRUE) #the first line as the names of the variables 
```

##  Question 1b

```{R question_1_b}
summary(rawdata)
table(rawdata$tr)
logdata <- cbind(rawdata[,1],log(rawdata[,c(2,3,4)])) #log the data
names(logdata) <- c("tr","hp","wt","mpg")#rename the names of the variables 
pairs(logdata[,2:4], # plot log(hp), log(wt), log(mpg)
      main = "Plot Between log Variables -- 3 species", #add the main title
      pch = c(21,24)[unclass(logdata$tr)+1], #different tr shows different shape
      bg = c("red", "green3")[unclass(logdata$tr)+1]) #different tr shows different colour
boxplot(mpg~tr, #MPG by TR
        data=rawdata, #set the dataset
        xlab="Gear Transmission Type" , #add the xlab title
        ylab="Miles Per Gallon", #add the ylab title
        main="MPG by Gear Transmission Type", #add the main title
        names=c("Automatic","Manual")) #change xlab value to character
t.test(mpg~tr, data=logdata)# the t-test above MPG is related to TR.
```

##  question 1c

```{R question_1_c}
rawdata_model<-lm(mpg~tr+hp+wt, data=rawdata) #rawdata linear model
logdata_model<-lm(mpg~tr+hp+wt, data=logdata) #logdata linear model
summary(rawdata_model)
summary(logdata_model)
summary(logdata_model$residuals)
best_model<-step(logdata_model, direction="both")
summary(best_model)
summary(best_model$residuals)
par(mfrow=c(2,2)) #put 4 graphes together
plot(best_model)#plot 4 graphes as following. 
#addition: if you run the last line code directly, there will be an error "figure margins too large".
#there two way to fix it: 1, click "clear all plots" and then run it. 
#                         2, run >>x11() at first if you are run in Windows computer.
#BTW: there is no error if i use it in R Markdown

```
